;/*!common:widget/menu/menu.js*/
define("common:widget/menu/menu.js",function(e,n,s){var i=e("common:static/util/account"),r={init:function(){var e=this;e.user=i.getUser(),e.render(),e.bind()},render:function(){var e=this,n=$("#userName"),s=$("#userLogin"),i=$("#userOrderlist"),r=$("#userLogout"),o=e.user,t=o.avatar,u=o.username;o&&o.status?($("#userInfo").removeClass("hide"),t&&n.find(".avatar").attr({src:t}),n.find(".name").html(u).end().removeClass("hide"),r.removeClass("hide"),i.removeClass("hide")):s.removeClass("hide")},bind:function(){{var e=this,n=$("#userInfo"),s=n.find(".slidedown");s.find("span")}$("#userLogout").click(function(){i.logout(Page.getData())}),$("#userLogin").click(function(){i.login()});var r=function(){e.tipTimer=setTimeout(function(){n.removeClass("user-hover")},200)};n.on("mouseenter",function(){n.addClass("user-hover"),clearTimeout(e.tipTimer)}),n.on("mouseleave",r)}};s.exports=r});
;/*!common:widget/nav/city/city.js*/
define("common:widget/nav/city/city.js",function(require,exports,module){var urls={citylist:"/common/city/citylist"},bdTemplate=require("common:static/util/bdTemplate"),location=require("common:static/util/location"),http=require("common:static/util/http"),CITY_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("");var list=hot||[];_template_fun_array.push("");var len=list.length;_template_fun_array.push("");for(var i=0;len>i;i++){_template_fun_array.push("");var city=list[i];_template_fun_array.push('<li>    <a href="javascript:;" data-id=',"undefined"==typeof city.id?"":baidu.template._encodeHTML(city.id)," data-name=","undefined"==typeof city.name?"":baidu.template._encodeHTML(city.name),">","undefined"==typeof city.name?"":baidu.template._encodeHTML(city.name),"</a></li>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],city={init:function(){var t=this;t.getEle(),t.bind(),t.getCityList()},getEle:function(){var t=this;t.selectedCity=$("#selectedCity"),t.citylist=$("#citylist"),t.hotCityList=$("#hotCityList"),t.cityArea=$("#cityArea")},render:function(){var t=this;t.showCurCity()},showCurCity:function(){var t,e=this,i=Page.getData(),a=i.cityId,n="",r=location.getSelectedCity(),c=r.cityName,o=e.cityData,l=o.all||[],s=l.length;if(a&&s>0)for(var y=0;s>y;y++)if(t=l[y]||{},t.id==a){a=t.id,n=t.name||"";break}c=n||c,e.selectedCity.html(c)},bind:function(){var t=this;t.cityArea.on("mouseenter",t.show),t.cityArea.on("mouseleave",t.hide),t.citylist.on("mouseenter",t.show),t.citylist.on("mouseleave",t.hide),t.hotCityList.on("click","a",function(){t.selectCity($(this))})},show:function(){var t=city;clearTimeout(t.cityHideTimeout),t.cityArea.addClass("city-area-hover")},hide:function(){var t=city;clearTimeout(t.cityHideTimeout),t.cityHideTimeout=setTimeout(function(){t.cityArea.removeClass("city-area-hover")},200)},getCityList:function(){var t=this,e=urls.citylist;http.ajax({url:e,data:{hasLetter:!1,isjson:!1},success:function(e){if(e&&0==e.errorNo&&e.data){t.cityData=e.data||[];var i=t.createCitylist(e);t.hotCityList.html(i),t.render()}}})},createCitylist:function(t){t=t||{};var e=t.data=t.data||{},i=CITY_TMPL(e);return i},selectCity:function(t){var e=t.attr("data-id"),i=t.attr("data-name"),a={cityId:e,cityName:i},n=window.location.href;location.saveSelectedCity(a),Page.start(n,{cityId:e})}};module.exports=city});
;/*!common:widget/nav/nav.js*/
define("common:widget/nav/nav.js",function(t,a,n){var e=t("common:static/util/http"),i=t("common:static/util/location"),c={init:function(){var t=this;t.ele=$("movieNav"),t.searchBtn=$("#movieSearch"),t.searchInput=$("#searchInput"),t.pageData=Page.getData(),t.location=i.getCity(),t.bind()},bind:function(){var t=this;t.searchBtn.click(function(){var a=$(this).siblings(".input").val();t.search(a)}),t.searchInput.keydown(function(a){if(13==a.keyCode){var n=t.searchInput.val();t.search(n)}})},search:function(t){var a=this;(t||0===t)&&e.ajax({url:"/common/search",data:{query:t,cityId:a.location.cityId},success:function(t){t=t||{};var n=t.data||{},e=n.hitUnderstand,i=n.movieId,c=[1,2];e&&c.indexOf(e)<0||2==e&&!i?a.showEmpty():a.pageJump(e,i)},error:function(){}})},showEmpty:function(){alert("没有对应的搜索结果~")},pageJump:function(t,a){var n=this,e=n.getUrl(t,a);e&&Page.start(e)},getUrl:function(t,a){var a,n=this,e="";switch(t){case 1:e+="/index";break;case 2:e+="/movie/detail?movieId="+a;break;default:n.showEmpty()}return e}};n.exports=c});
;/*!common:widget/ui/backup/backup.js*/
define("common:widget/ui/backup/backup.js",function(require,exports,module){var BACKUP_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<a href="javascript:;" class="widget-common-backup backup-btn" id="widgetCommonBackup">    <span class="arrow"></span>    <em class="arrow-in"></em></a>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],Backup=function(t){this.opt=t||{},this.render(),this.setOptions(),this.bind()};Backup.prototype.render=function(){var t=this,e=t.opt,o=e.container||"body",a=BACKUP_TMPL(e);$(a).appendTo($(o));var i=$("#widgetCommonBackup");t.ele=i},Backup.prototype.setOptions=function(t){var e=this,o=$(window).height(),a={bottomOffset:40,rightOffset:100,locationOffset:.5*o,scrollTime:100};this.defaultOption=a,$.extend(a,t||{}),this.bottomOffset=a.bottomOffset,this.rightOffset=a.rightOffset,this.locationOffset=a.locationOffset,this.scrollTime=a.scrollTime,e.setPosition(),e.toggleHide()},Backup.prototype.setPosition=function(){var t=this,e=t.ele,o=t.bottomOffset,a=(t.winHeight,o),i=t.rightOffset;e.css({bottom:a,right:i})},Backup.prototype.toggleHide=function(){var t=this,e=t.ele,o=(t.winHeight,$("body").scrollTop()),a=t.locationOffset;if(o>=a){if(e.hasClass("active"))return;e.addClass("active"),1!==e.css("opacity")&&e.animate({opacity:1},500,function(){t.easing=!0})}else{if(!e.hasClass("active"))return;e.removeClass("active"),0!==e.css("opacity")&&e.animate({opacity:0},500)}},Backup.prototype.bind=function(){var t=this;$(window).on("scroll",function(){var e=Date.now(),o=t.lastTime;e-o>=100?t.toggleHide():(clearTimeout(t.toggleTimeout),t.toggleTimeout=setTimeout(function(){t.toggleHide()},100))}),t.ele.on("click",function(){t.scrollTo(t.scrollTime)})},Backup.prototype.scrollTo=function(t){var e=10,o=$("body"),a=o.scrollTop(),i=parseInt(t/e),n=Math.ceil(a/i),s=function(){a=o.scrollTop(),i--,setTimeout(function(){0===a&&0>=i||(a=a-n>0?a-n:0,o.scrollTop(a),s())},e)};s()},module.exports=Backup});
;/*!common:widget/ui/cheat/cheat.js*/
define("common:widget/ui/cheat/cheat.js",function(require,exports,module){var urls={retrieve:"/common/captcha/retrieve",validate:"/common/captcha/validate"},CHEAT_TMPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="widget-common-ui-cheat"><div class="cheat-captcha"><h3>请输入验证码：</h3><div>    <img id="cheatCaptcha" src="',"undefined"==typeof cheatCaptcha?"":baidu.template._encodeHTML(cheatCaptcha),'" />    <input class="text" type="text" id="captchaInput" />    </div>    <div>    <a href="javascript:;" id="confirmCaptcha" class="confirm-captcha">确认验证</a>    <a href="javascript:;" id="refreshCaptcha" class="refresh">刷新验证码</a>    <p id="errorMsg" class="error-msg hide">验证失败 请重新输入验证码</p>    </div></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],http=require("common:static/util/http"),dialog=require("common:widget/ui/dialog/dialog"),cheat={status:{accessing:!1},init:function(){var a=this;a.retrieve()},retrieve:function(a){var t=this,e=urls.retrieve;t.retrieveStatus||(t.retrieveStatus=!0,http.ajax({url:e,data:{type:0},success:function(e){return t.cheatStr=t.createCaptcha(e),t.retrieveStatus=!1,"refresh"==a?void t.refresh(e):void t.show()},error:function(){t.retrieveStatus=!1}}))},createCaptcha:function(a){var t="";return a&&a.data&&a.data.captcha&&(t=CHEAT_TMPL({cheatCaptcha:a.data.captcha})),t},refresh:function(a){if(a&&a.data&&a.data.captcha){var t=a.data.captcha,e=$("#cheatCaptcha");e.attr("src",t)}},show:function(){var a=this,t=a.cheatStr;a.dialog=dialog.init({html:t,height:200,width:180}),a.dialog.show(),a.bind()},bind:function(){var a=this,t=$("#confirmCaptcha"),e=$("#captchaInput"),r=$("#refreshCaptcha");t&&t.length>0&&(t.off(),t.on("click",function(){e.val()&&(a.validateStatus||(a.validateStatus=!0,a.validate()))}),e.off(),e.on("focus",function(){a.hideError()}),r.on("click",function(){a.retrieve("refresh")}))},validate:function(){var a=this,t=urls.validate,e=$("#captchaInput"),r=e.val();http.ajax({url:t,data:{type:0,captcha:r},success:function(t){t&&0==t.errorNo&&t.result?window.location.reload():a.showError(),a.validateStatus=!1},error:function(){a.validateStatus=!1,a.showError()}})},showError:function(){var a=this,t=$("#errorMsg");t.removeClass("hide"),a.retrieve("refresh")},hideError:function(){var a=$("#errorMsg");a.addClass("hide")}};module.exports=cheat});