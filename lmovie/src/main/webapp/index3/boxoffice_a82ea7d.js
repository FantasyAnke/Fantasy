define("movie:widget/boxoffice/boxoffice.js",function(t,a,e){var l={boxOffice:"/movie/boxoffice",boxRefresh:"/movie/boxrefresh"},o=(t("common:widget/ui/pager/pager"),t("common:widget/ui/backup/backup")),i=(t("common:static/util/http"),t("common:static/util/util"));t("movie:widget/boxoffice/calendar/calendarmaker.js");var c={todaystr:i.dateFormat(new Date,"yyyy-MM-dd"),timer:null,init:function(t){var a=c,e=$(".calendar"),l=$(".calendar-togger"),s=[["20110101","today"]].concat(t.pre);e.calendar({highlightRange:[["today","today"]],limitRange:s,onSelect:a.onSelectFn}),l.on("click",function(){"none"===e.css("display")?(e.slideDown(),setTimeout(function(){e.css("display","block"),l.css("background-position-y","-34px")},100)):"block"===e.css("display")&&(e.slideUp(),setTimeout(function(){e.css("display","none"),l.css("background-position-y","-26px")},390))}),clearInterval(a.timer);var m=i.dateFormat(new Date,"yyyy-MM-dd");a.refreshNum(m),a.timer=setInterval(function(){m=i.dateFormat(new Date,"yyyy-MM-dd"),a.refreshNum(m)},1e4);var d=$(".each-movie .colm-1");d.on("click",function(){location.href=$(this).attr("to-url")}),new o},onSelectFn:function(t){var a=c,e=$(".calendar"),l=$(".calendar-togger"),o=t[0].year+"年"+(t[0].month>9?t[0].month:"0"+t[0].month)+"月"+((t[0].day>9?t[0].day:"0"+t[0].day)+"日");$("#selectedDay").html(o);var s=["周日","周一","周二","周三","周四","周五","周六"],m=t[0].year+"-"+(t[0].month>9?t[0].month:"0"+t[0].month)+"-"+(t[0].day>9?t[0].day:"0"+t[0].day);m!==a.todaystr?($("#outline").html("当日大盘（"+s[t[0].week]+"）"),clearInterval(a.timer),a.refreshNum(m)):($("#outline").html("今日大盘（"+s[(new Date).getDay()]+"）"),clearInterval(a.timer),a.refreshNum(a.todaystr),a.timer=setInterval(function(){var t=i.dateFormat(new Date,"yyyy-MM-dd");a.refreshNum(t)},1e4)),e.slideUp(),setTimeout(function(){e.css("display","none"),l.css("background-position-y","-26px")},390)},refreshNum:function(t){function a(t){var a=t.data.total,e=t.data.detail,l=$("#total-boxNum"),i=$("#total-message"),c=$("#total-scheNum"),s=$("#total-ticketNum"),m=$("#total-avgPrice"),d=$("#total-predictBox"),n=$("#movie-table");if(a&&(l.html(a.boxNum),i.html(o+a.message),c.html(a.scheNum),s.html(a.ticketNum),m.html(a.avgPrice),d.html(a.predictBox)),e){for(var r='<dt class="table-title clearfix"><div class="column colm-1">影片</div><div class="column colm-2">实时票房</div><div class="column colm-3">票房占比</div><div class="column colm-4">排片占比</div><div class="column colm-5">上座率</div><div class="column colm-6">排座占比</div><div class="column colm-7">场次</div><div class="column colm-8">人次</div><div class="column colm-9">场均人次</div><div class="column colm-10">场均收入</div><div class="column colm-11">平均票价</div></dt>',u=0;u<e.length;u++)r+='<dd class="each-movie clearfix"><div class="column colm-1" to-url="/movie/detail?movieId='+e[u].movieId+'" data-data={"movieId":'+e[u].movieId+'}><h5 class="movie-title">'+e[u].movieName+'</h5><ul class="movie-info clearfix"><li class="days">上映'+e[u].attribute[1].attrValue+'天</li><li class="totals"><span>'+e[u].attribute[2].attrValue+'</span></li></ul></div><div class="column colm-2">'+e[u].attribute[3].attrValue+'</div><div class="column colm-3">'+e[u].attribute[4].attrValue+'%</div><div class="column colm-4">'+e[u].attribute[5].attrValue+'%</div><div class="column colm-5">'+e[u].attribute[6].attrValue+'%</div><div class="column colm-6">'+e[u].attribute[7].attrValue+'%</div><div class="column colm-7">'+e[u].attribute[8].attrValue+'</div><div class="column colm-8">'+e[u].attribute[9].attrValue+'</div><div class="column colm-9">'+e[u].attribute[10].attrValue+'</div><div class="column colm-10">'+e[u].attribute[11].attrValue+'</div><div class="column colm-11">'+e[u].attribute[12].attrValue+"</div></dd>";n.html(r);var v=$(".each-movie .colm-1");v.on("click",function(){location.href=$(this).attr("to-url")})}}var e=c,o="截至";t!==e.todaystr&&(o=""),$.ajax({type:"POST",url:l.boxRefresh,data:{isAjax:!0,date:t},success:function(t){a(t.real)},dataType:"json"})}};e.exports=c});